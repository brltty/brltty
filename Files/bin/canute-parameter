#!/bin/bash
. /brltty/current/libexec/canute-prologue.sh

showProgramUsageNotes() {
cat <<END_OF_PROGRAM_USAGE_NOTES

If the parameter's name isn't specified then all the parameters are listed.
If just a name is specified then only that parameter's value is shown.
If a value is also specified then it's assigned to the named parameter.
END_OF_PROGRAM_USAGE_NOTES
}

optionalProgramParameters
addProgramParameter "name" apiParameter "the name of a BrlAPI parameter"
addProgramParameter "value" newValue "the new value to assign to the parameter"
parseProgramArguments "${@}"

apiCommand() {
   local command="${1}"
   shift 1

   canute-apitool "${command}" -server "localhost:${session}" "${@}"
   return "${?}"
}

if [ -n "${DISPLAY}" ]
then
   session=1
else
   session=0
fi

if [ -n "${newValue}" ]
then
   apiCommand set-parameter "${apiParameter}" "${newValue}"
   returnCode="${?}"
elif [ -n "${apiParameter}" ]
then
   apiCommand list-parameter "${apiParameter}"
   returnCode="${?}"
else
   apiCommand list-parameters
   returnCode="${?}"
fi

exit "${returnCode}"
